(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65046,       1835]
NotebookOptionsPosition[     62311,       1781]
NotebookOutlinePosition[     62665,       1797]
CellTagsIndexPosition[     62622,       1794]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definition of the geometric tensors and symbols", "Section",
 CellChangeTimes->{{3.731791243676896*^9, 3.7317912692201757`*^9}, {
  3.73179618197985*^9, 3.731796183720833*^9}, {3.731845291813898*^9, 
  3.731845294946474*^9}},ExpressionUUID->"a8c6c20f-3e06-420e-8fee-\
d4bb4fd18b67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"L", "\[Rule]", 
    RowBox[{"\[CapitalDelta]", "*"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "[", "c_", "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"r", "^", "2"}]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"D", "[", 
            RowBox[{"c", ",", "\[Theta]"}], "]"}]}], ",", "\[Theta]"}], 
         "]"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]], 
        RowBox[{"D", "[", 
         RowBox[{"c", ",", 
          RowBox[{"{", 
           RowBox[{"\[Phi]", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.732373592957716*^9, 3.732373596454184*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"03e59733-ee43-4d96-82dd-fb86b8782eed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"parameters", " ", "\[Theta]", " ", "and", " ", "\[Phi]"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Xi]", "=", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     SubscriptBox["g", "ij"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "^", "2"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"r", "^", "2"}], " ", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}]}]}], "}"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"detg", "=", 
     RowBox[{"det", 
      RowBox[{"(", 
       SubscriptBox["g", "ij"], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"detg", "=", 
     RowBox[{"Det", "[", "g", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"gsub", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
     SubscriptBox["g", "i"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gsub", "=", 
     RowBox[{"r", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"gsup", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
     SuperscriptBox["g", "i"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gsup", "=", 
     RowBox[{
      RowBox[{"1", "/", "r"}], "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}], "/", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}]}]}], "}"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"n", " ", "normal", " ", "vector"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ig", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     SuperscriptBox["g", "ij"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ig", "=", 
     RowBox[{"Inverse", "[", "g", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[CapitalGamma]", "[", 
      RowBox[{"[", 
       RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], " ", "\[Rule]", " ", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["\[CapitalGamma]", "k"], ")"}], "ij"]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalGamma]", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ig", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "l"}], "]"}], "]"}], "/", "2"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"g", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"\[Xi]", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "+", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"g", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "j"}], "]"}], "]"}], ",", 
               RowBox[{"\[Xi]", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"g", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
               RowBox[{"\[Xi]", "[", 
                RowBox[{"[", "l", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"[", 
       RowBox[{"k", ",", "l", ",", "i", ",", "j"}], "]"}], "]"}], " ", 
     "\[Rule]", " ", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["R", "k"], ")"}], "lij"]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "l", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "-", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "l", ",", "i"}], "]"}], "]"}], ",", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "i", ",", "m"}], "]"}], "]"}], 
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "l", ",", "j"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "j", ",", "m"}], "]"}], "]"}], 
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "l", ",", "i"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "2"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Rb", "[", 
      RowBox[{"[", 
       RowBox[{"k", ",", "l", ",", "i", ",", "j"}], "]"}], "]"}], " ", 
     "\[Rule]", " ", 
     SubscriptBox["R", "klij"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "m"}], "]"}], "]"}], 
          RowBox[{"R", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "l", ",", "i", ",", "j"}], "]"}], "]"}]}], ",", 
         
         RowBox[{"{", 
          RowBox[{"m", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "\[Rule]", " ", 
     SubscriptBox["b", "ij"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"gsub", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ".", "n"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Gamma]", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Rule]", 
      SubscriptBox["\[Gamma]", "ij"]}], "=", 
     RowBox[{
      RowBox[{"\[Sqrt]", "g"}], " ", 
      SubscriptBox["e", "ij"]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]", "=", 
     RowBox[{
      RowBox[{"r", "^", "2"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"i\[Gamma]", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Rule]", 
      SuperscriptBox["\[Gamma]", "ij"]}], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Sqrt]", "g"}], ")"}], 
       RowBox[{"-", "1"}]], " ", 
      SubscriptBox["e", "ij"]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i\[Gamma]", "=", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "^", "2"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ")"}]}], "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"check", " ", 
      SubscriptBox["R", "klij"]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["b", "ki"], 
       SubscriptBox["b", "lj"]}], "-", 
      RowBox[{
       SubscriptBox["b", "kj"], 
       SubscriptBox["b", "li"]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "i"}], "]"}], "]"}], 
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"l", ",", "j"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "j"}], "]"}], "]"}], 
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"l", ",", "i"}], "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "-", "Rb"}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7317912053146763`*^9, 3.731791233559148*^9}, {
  3.731791273300652*^9, 3.731791339735214*^9}, {3.731791370330159*^9, 
  3.731791371697562*^9}, {3.731791432798522*^9, 3.731791604336434*^9}, {
  3.731791687286647*^9, 3.731791787714436*^9}, {3.7317918771375637`*^9, 
  3.731792160534037*^9}, {3.731792222195211*^9, 3.7317922857651577`*^9}, {
  3.731792330951408*^9, 3.731792827197372*^9}, {3.731792866121607*^9, 
  3.731793006964551*^9}, {3.731793080275318*^9, 3.7317931403136683`*^9}, {
  3.731793311919373*^9, 3.731793316325089*^9}, {3.7317933560538073`*^9, 
  3.73179346224727*^9}, {3.731893568267926*^9, 3.731893600496088*^9}, {
  3.732373735693699*^9, 
  3.7323737481960993`*^9}},ExpressionUUID->"aa6059a6-d422-4ec4-aa8b-\
534b92e6ff6c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.731791605489028*^9, {3.731791697993197*^9, 3.7317917051864567`*^9}, 
   3.731792084154736*^9, 3.731792286340187*^9, 3.731792354729063*^9, {
   3.731792579646577*^9, 3.731792587082493*^9}, {3.7317927122433367`*^9, 
   3.731792718928491*^9}, 3.7317931419128733`*^9, 3.731793360116274*^9, {
   3.731793457990797*^9, 3.731793462872817*^9}, 3.7317963191498203`*^9, 
   3.731845297472652*^9, 3.7318936979109907`*^9, 3.732370659618032*^9, 
   3.732371063322036*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"bcd70b07-9b1b-4ce6-accb-849dc4143a02"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition of the elastic variables", "Section",
 CellChangeTimes->{{3.731793652627945*^9, 
  3.731793688121792*^9}},ExpressionUUID->"ea01728a-a533-41e0-908a-\
f548677cc4b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"uv", " ", "is", " ", "the", " ", "displacement", " ", "field"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"uv", " ", "=", " ", 
      RowBox[{
       SubscriptBox["u", "i"], 
       SuperscriptBox["g", "i"]}]}], ";", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "[", "i", "]"}], 
      "\[Rule]", 
      SubscriptBox["u", "i"]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"uv", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "[", "i", "]"}], 
          RowBox[{"gsup", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2"}], "}"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "[", "3", "]"}], 
        "n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Rho]", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Rule]", 
     SubscriptBox["\[Rho]", "ij"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"uv", ",", 
               RowBox[{"\[Xi]", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], 
              RowBox[{"D", "[", 
               RowBox[{"uv", ",", 
                RowBox[{"\[Xi]", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "2"}], "}"}]}], "]"}]}], ")"}], ".", "n"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "right", " ", "hand", " ", "side", " ", "of", " ", "the", " ", 
     "compatibility", " ", "equation", " ", "from", " ", 
     RowBox[{"Ciarlet", " ", "'"}], "08"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"i\[Gamma]", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "k"}], "]"}], "]"}]}], 
         RowBox[{"i\[Gamma]", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "l"}], "]"}], "]"}], 
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "l"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "\[Epsilon]u", " ", "is", " ", "the", " ", "strain", " ", "tensor", " ", 
      "in", " ", "terms", " ", "of", " ", "displacement"}], ",", " ", 
     RowBox[{
      RowBox[{"\[Epsilon]u", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
      SubscriptBox["\[Epsilon]", "ij"]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]u", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"uv", ",", 
              RowBox[{"\[Xi]", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ".", 
            RowBox[{"gsub", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"uv", ",", 
              RowBox[{"\[Xi]", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ".", 
            RowBox[{"gsub", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "to", " ", "check", " ", "if", " ", "the", " ", "right", " ", "hand", " ",
      "side", " ", "is", " ", 
     RowBox[{"this", ":", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "\[Kappa]", " ", 
        SuperscriptBox["g", "ij"], 
        SubscriptBox["\[Epsilon]", "ij"]}], "+", 
       RowBox[{
        FractionBox["1", "r"], 
        SubscriptBox["\[CapitalDelta]u", "3"]}], "+", 
       FractionBox[
        RowBox[{"2", 
         SubscriptBox["u", "3"]}], 
        SuperscriptBox["r", "3"]]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "\[Kappa]g", " ", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ig", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], 
              RowBox[{"\[Epsilon]u", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"L", "[", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "[", "3", "]"}], 
           "]"}], "/", "r"}]}], "]"}], "+", 
       RowBox[{"2", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "[", "3", "]"}], "/", 
         RowBox[{"r", "^", "3"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"p", "-", "q"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.731793503994562*^9, 3.731793620599537*^9}, {
  3.731793693201725*^9, 3.731793911680882*^9}, {3.731793949348268*^9, 
  3.731793983560913*^9}, {3.731794013774872*^9, 3.731794017996491*^9}, {
  3.731794090737883*^9, 3.7317941151012573`*^9}, {3.731794157529461*^9, 
  3.731794251015533*^9}, {3.731794456190278*^9, 3.731794477997521*^9}, {
  3.731795435369843*^9, 3.731795518124098*^9}, {3.731796123824808*^9, 
  3.731796163387129*^9}, {3.731796261587352*^9, 3.731796272639596*^9}, {
  3.731796334288611*^9, 3.7317963433320827`*^9}, {3.7318425617602177`*^9, 
  3.731842581760088*^9}, {3.7318426118799143`*^9, 3.7318426135761623`*^9}, {
  3.732373121426485*^9, 3.7323731327409887`*^9}, {3.732373288611166*^9, 
  3.7323733178063107`*^9}, {3.7323737617703876`*^9, 3.7323739058537683`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"0b3eb555-58a0-48b1-b0e6-61b5d1f9909b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.731844027702557*^9, {3.731844059086199*^9, 3.731844074000711*^9}, 
   3.731844110636324*^9, 3.732370660395164*^9, 3.732371063642709*^9, {
   3.732373893855125*^9, 3.73237390691369*^9}},
 CellLabel->
  "Out[123]=",ExpressionUUID->"cd3a3d57-4817-4af7-817a-247dcc378942"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Gradient", " ", "of", " ", "\[Chi]"}], ",", " ", 
    RowBox[{"D\[Chi]ij", "\[Rule]", 
     RowBox[{
      SubscriptBox["\[Del]", "i"], "\[Chi]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"D\[Chi]ij", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Chi]", "[", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"double", " ", "gradient", " ", "of", " ", "\[Chi]"}], ",", " ", 
     
     RowBox[{"DD\[Chi]ij", "\[Rule]", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Del]", "i"], 
        RowBox[{
         SubscriptBox["\[Del]", "j"], "\[Chi]"}]}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DD\[Chi]ij", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D\[Chi]ij", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalGamma]", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], 
           RowBox[{"D\[Chi]ij", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "2"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "\[Kappa]g", " ", "is", " ", "the", " ", "Gaussia", " ", "curvature"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Kappa]g", "=", 
     RowBox[{"1", "/", 
      RowBox[{"r", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "\[Sigma]ij", " ", "components", " ", "of", " ", "stress", " ", 
      "tensor"}], ",", " ", 
     RowBox[{
      RowBox[{"\[Sigma]ij", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Rule]", " ", 
      SuperscriptBox["\[Sigma]", "ij"]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]ij", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i\[Gamma]", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "k"}], "]"}], "]"}], 
            RowBox[{"i\[Gamma]", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "l"}], "]"}], "]"}], 
            RowBox[{"DD\[Chi]ij", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "l"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "-", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i\[Gamma]", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "p"}], "]"}], "]"}], 
             RowBox[{"g", "[", 
              RowBox[{"[", 
               RowBox[{"p", ",", "m"}], "]"}], "]"}], 
             RowBox[{"i\[Gamma]", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "k"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"p", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "2"}], "}"}]}], "]"}], "\[Kappa]g", " ", 
          RowBox[{"\[Chi]", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"check", " ", "the", " ", 
     RowBox[{"Laplacian", " ", "--"}], " ", "it", " ", "works"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], 
       RowBox[{"\[Sigma]ij", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
    "\[Sigma]", " ", "is", " ", "the", " ", "tensor", " ", "form", " ", "of", 
     " ", "the", " ", "stress"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Sigma]ij", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], 
         RowBox[{"TensorProduct", "[", 
          RowBox[{
           RowBox[{"gsub", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"gsub", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"check", " ", "equilibrium", " ", "equation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"gsup", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ".", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gsup", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ".", 
         RowBox[{"D", "[", 
          RowBox[{"\[Sigma]", ",", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}]}], "]"}], "]"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.7318704055768538`*^9, 3.7318704120963697`*^9}, {
   3.731870539122828*^9, 3.7318706932521563`*^9}, {3.731870772815984*^9, 
   3.731870794759506*^9}, {3.731870843084379*^9, 3.7318708463221407`*^9}, {
   3.731870877984961*^9, 3.731870937443569*^9}, {3.731871022136675*^9, 
   3.731871028291357*^9}, {3.731871062491872*^9, 3.731871066988432*^9}, {
   3.731871097549417*^9, 3.731871160006927*^9}, {3.73187280464598*^9, 
   3.731872808229278*^9}, {3.731872839383198*^9, 3.731872904386547*^9}, {
   3.731872948702004*^9, 3.7318729543398247`*^9}, {3.731872993538389*^9, 
   3.731873128898466*^9}, {3.7318735813565207`*^9, 3.7318735836301394`*^9}, 
   3.731874102072968*^9, {3.731874151597447*^9, 3.731874213133738*^9}, {
   3.731874362719742*^9, 3.7318743792064342`*^9}, {3.731874519340248*^9, 
   3.7318746282864943`*^9}, {3.73187483791313*^9, 3.7318749660685797`*^9}, {
   3.731875021728655*^9, 3.731875024002287*^9}, {3.731875676442153*^9, 
   3.731875694394236*^9}, {3.731876447914465*^9, 3.731876448405591*^9}, {
   3.731876577254684*^9, 3.731876674999426*^9}, {3.731878305092545*^9, 
   3.731878330038327*^9}, {3.731880110615623*^9, 3.7318801240536947`*^9}, 
   3.7318832576988297`*^9, {3.731884245325552*^9, 3.731884249401391*^9}, 
   3.731886298861618*^9, {3.73189269798505*^9, 3.731892948918063*^9}, {
   3.731892979860709*^9, 3.731893057307694*^9}, 3.731893163714541*^9, {
   3.731893203239365*^9, 3.731893206875928*^9}, {3.732371057797072*^9, 
   3.7323710591145973`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"5c6fc8ae-4681-42ec-87ef-ef76fb63d06a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{"\[Chi]", "[", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["\[Chi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Chi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["\[Chi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"2", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], 
  SuperscriptBox["r", "2"]]], "Output",
 CellChangeTimes->{{3.7318728787380342`*^9, 3.731872906061232*^9}, {
   3.73187308905201*^9, 3.731873096749015*^9}, 3.731874647849113*^9, 
   3.7318766174348516`*^9, {3.731876667887513*^9, 3.731876675521134*^9}, {
   3.731878316776361*^9, 3.731878330698626*^9}, 3.731883334613367*^9, 
   3.7318842560730667`*^9, 3.731886311868825*^9, 3.731893076359585*^9, 
   3.731893164958851*^9, 3.7323706605926533`*^9, 3.732371063773978*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"8aa6b92f-6320-4006-aed4-17bcd0142b55"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7318728787380342`*^9, 3.731872906061232*^9}, {
   3.73187308905201*^9, 3.731873096749015*^9}, 3.731874647849113*^9, 
   3.7318766174348516`*^9, {3.731876667887513*^9, 3.731876675521134*^9}, {
   3.731878316776361*^9, 3.731878330698626*^9}, 3.731883334613367*^9, 
   3.7318842560730667`*^9, 3.731886311868825*^9, 3.731893076359585*^9, 
   3.731893164958851*^9, 3.7323706605926533`*^9, 3.732371064263628*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"8020f955-bd92-4f41-b3e4-d8d92a53b89d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\[Epsilon]ij", " ", "components", " ", "of", " ", "stress", " ", 
     "tensor"}], ",", " ", 
    RowBox[{
     RowBox[{"\[Epsilon]ij", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Rule]", " ", 
     SubscriptBox["\[Epsilon]", "ij"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Epsilon]ij", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Nu]"}], ")"}], "/", "Y"}], "*", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"g", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "k"}], "]"}], "]"}], 
             RowBox[{"g", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "l"}], "]"}], "]"}], 
             RowBox[{"\[Sigma]ij", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "l"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "-", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Nu]", "/", "Y"}], "*", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"g", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], 
             RowBox[{"g", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "l"}], "]"}], "]"}], 
             RowBox[{"\[Sigma]ij", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "l"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "\[Epsilon]", " ", "is", " ", "the", " ", "tensor", " ", "form", " ", 
     "of", " ", "the", " ", "strain"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]ij", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], 
         RowBox[{"TensorProduct", "[", 
          RowBox[{
           RowBox[{"gsup", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"gsup", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "D\[Epsilon]ij", " ", "is", " ", "the", " ", "component", " ", "of", " ",
       "the", " ", "gradient", " ", "of", " ", "the", " ", "strain", " ", 
      RowBox[{"D\[Epsilon]ij", "[", 
       RowBox[{"[", 
        RowBox[{"l", ",", "i", ",", "j"}], "]"}], "]"}]}], "\[Rule]", 
     RowBox[{
      SubscriptBox["\[Del]", "l"], 
      SubscriptBox["\[Epsilon]", "ij"]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D\[Epsilon]ij", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]ij", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "-", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Epsilon]ij", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "j"}], "]"}], "]"}], 
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "i", ",", "l"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"\[Epsilon]ij", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "k"}], "]"}], "]"}], 
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "j", ",", "l"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "2"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "DD\[Epsilon]ij", " ", "is", " ", "the", " ", "component", " ", "of", 
      " ", "the", " ", "double", " ", "gradient", " ", "of", " ", "the", " ", 
      "strain", " ", 
      RowBox[{"DD\[Epsilon]ij", "[", 
       RowBox[{"[", 
        RowBox[{"k", ",", "l", ",", "i", ",", "j"}], "]"}], "]"}]}], 
     "\[Rule]", 
     RowBox[{
      SubscriptBox["\[Del]", "k"], 
      RowBox[{
       SubscriptBox["\[Del]", "l"], 
       SubscriptBox["\[Epsilon]", "ij"]}]}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"DD\[Epsilon]ij", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D\[Epsilon]ij", "[", 
            RowBox[{"[", 
             RowBox[{"l", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "-", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"D\[Epsilon]ij", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "i", ",", "j"}], "]"}], "]"}], 
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "k", ",", "l"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"D\[Epsilon]ij", "[", 
              RowBox[{"[", 
               RowBox[{"l", ",", "m", ",", "j"}], "]"}], "]"}], 
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "k", ",", "i"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"D\[Epsilon]ij", "[", 
              RowBox[{"[", 
               RowBox[{"l", ",", "i", ",", "m"}], "]"}], "]"}], 
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "k", ",", "j"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "2"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"calculate", " ", 
     SuperscriptBox["\[Gamma]", "ik"], 
     SuperscriptBox["\[Gamma]", "jl"], 
     RowBox[{
      SubscriptBox["\[Del]", "k"], 
      RowBox[{
       SubscriptBox["\[Del]", "l"], 
       SubscriptBox["\[Epsilon]", "ij"]}]}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i\[Gamma]", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "k"}], "]"}], "]"}], 
         RowBox[{"i\[Gamma]", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "l"}], "]"}], "]"}], 
         RowBox[{"DD\[Epsilon]ij", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "l", ",", "i", ",", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"calculate", " ", 
          FractionBox["1", "Y"], 
          SuperscriptBox["\[CapitalDelta]", "2"], "\[Chi]"}], "+", 
         RowBox[{
          FractionBox["2", "Y"], "\[Kappa]\[CapitalDelta]\[Chi]"}]}], ")"}], 
       "\[IndentingNewLine]", "q"}], "=", 
      RowBox[{"Expand", "[", 
       RowBox[{"TrigExpand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"L", "[", 
           RowBox[{"L", "[", 
            RowBox[{"\[Chi]", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}], "]"}], "/", 
          "Y"}], "+", 
         RowBox[{
          RowBox[{"2", "/", "Y"}], "*", "\[Kappa]g", "*", 
          RowBox[{"L", "[", 
           RowBox[{"\[Chi]", "[", 
            RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}]}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{"p", "-", "q"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.731873180644876*^9, 3.731873194254435*^9}, {
   3.731873248260295*^9, 3.731873334613593*^9}, {3.731873372217432*^9, 
   3.731873465112011*^9}, {3.731873520440036*^9, 3.731873560161372*^9}, {
   3.73187471082672*^9, 3.731874726184519*^9}, {3.731874791174519*^9, 
   3.7318747929231043`*^9}, 3.7318768629718103`*^9, {3.731880064348213*^9, 
   3.731880103532399*^9}, {3.731880181096998*^9, 3.73188029692271*^9}, {
   3.73188036572191*^9, 3.7318804612223463`*^9}, 3.7318833238267527`*^9, {
   3.731886204483996*^9, 3.731886217398925*^9}, 3.73188630791368*^9, {
   3.731886837326923*^9, 3.731886848359351*^9}, {3.7318913698134127`*^9, 
   3.7318914089459963`*^9}, {3.731891440604086*^9, 3.73189194654443*^9}, {
   3.73189198960513*^9, 3.731892001603621*^9}, {3.7318921209966784`*^9, 
   3.7318922470270777`*^9}, {3.731892291085904*^9, 3.731892362471348*^9}, {
   3.732373485177484*^9, 3.7323734859344053`*^9}, {3.732373587666399*^9, 
   3.7323735892071457`*^9}},ExpressionUUID->"1e4d7edd-50d0-48f3-a385-\
ce8061d26687"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7318919593548098`*^9, 3.731892014715657*^9, 
  3.7318923745375633`*^9, 3.731893226108241*^9, 3.732370680370446*^9, 
  3.732371066214052*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"2334429f-0e0e-45ca-8fdb-372f35670d11"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"calculate", " ", 
    SuperscriptBox["g", 
     RowBox[{"-", "1"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["R", "k"], ")"}], "112"], 
       SubscriptBox["\[Epsilon]", 
        RowBox[{"2", "k"}]]}], "-", 
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["R", "k"], ")"}], "212"], 
       SubscriptBox["\[Epsilon]", 
        RowBox[{"1", "k"}]]}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"1", "/", "detg"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], 
           RowBox[{"\[Epsilon]ij", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "k"}], "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], 
           RowBox[{"\[Epsilon]ij", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "k"}], "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"calculate", " ", "-", 
      RowBox[{"2", 
       FractionBox[
        RowBox[{"1", "-", "\[Nu]"}], "Y"], 
       SuperscriptBox["\[Kappa]", "2"], "\[Chi]"}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", "\[Nu]"}], "Y"], 
       "\[Kappa]\[CapitalDelta]\[Chi]"}]}], ",", " ", 
     RowBox[{"L", "\[Rule]", "\[CapitalDelta]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Nu]"}], ")"}], "/", "Y"}], "*", 
        RowBox[{"\[Kappa]g", "^", "2"}], "*", 
        RowBox[{"\[Chi]", "[", 
         RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Nu]"}], ")"}], "/", "Y"}], "*", "\[Kappa]g", 
        "*", 
        RowBox[{"L", "[", 
         RowBox[{"\[Chi]", "[", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"p", "-", "q"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "So", " ", "the", " ", "total", " ", "left", " ", "hand", " ", "side", 
      " ", "is", " ", 
      FractionBox["1", "Y"], 
      SuperscriptBox["\[CapitalDelta]", "2"], "\[Chi]"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Nu]"}], ")"}], "Y"], 
      "\[Kappa]\[CapitalDelta]\[Chi]"}], "-", 
     RowBox[{"2", 
      FractionBox[
       RowBox[{"1", "-", "\[Nu]"}], "Y"], 
      SuperscriptBox["\[Kappa]", "2"], "\[Chi]"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7318933688520937`*^9, 3.731893392023494*^9}, {
  3.7318934239045153`*^9, 3.731893491157316*^9}, {3.731893739597262*^9, 
  3.731893826409245*^9}, {3.731893945030072*^9, 3.731894103378832*^9}, {
  3.732373914213414*^9, 
  3.7323739623884373`*^9}},ExpressionUUID->"68531b8b-b7f2-4c08-8df8-\
ecbe8d1dc4f1"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.731894018370102*^9, 3.731894038338236*^9}, 
   3.731894115020454*^9, 3.732370680592121*^9, 3.73237106634058*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"4e504dcf-c8b0-44bc-b31d-734c1616074b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "1", "st", " ", "term", " ", "of", " ", "the", " ", "right", " ", "hand", 
    " ", "side", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "\[Kappa]"}], ")"}], " ", 
    SuperscriptBox["g", "ij"], 
    SubscriptBox["\[Epsilon]", "ij"], " ", "in", " ", "terms", " ", "of", " ",
     "Airy", " ", "stress"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ig", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], 
         RowBox[{"\[Epsilon]ij", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"check", " ", "if", " ", "it", " ", "is", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "\[Kappa]"}], ")"}], 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Nu]"}], ")"}], "Y"], 
     RowBox[{"(", 
      RowBox[{"\[CapitalDelta]\[Chi]", "+", 
       RowBox[{"2", "\[Kappa]\[Chi]"}]}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Nu]"}], ")"}], "/", "Y"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{"\[Chi]", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}], "+", 
         RowBox[{"2", "\[Kappa]g", " ", 
          RowBox[{"\[Chi]", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}]}], ")"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"p", "-", "q"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.732373984713326*^9, 3.732374015273286*^9}, {
  3.732374373209548*^9, 3.7323743904058533`*^9}, {3.7323744252094193`*^9, 
  3.732374502203121*^9}, {3.732374661584508*^9, 
  3.732374733451951*^9}},ExpressionUUID->"57695719-41c5-4d88-820d-\
a253f940c0b7"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.732374399281384*^9, {3.732374483539904*^9, 3.732374503081395*^9}},
 CellLabel->
  "Out[130]=",ExpressionUUID->"4754fb83-a100-4a22-87b4-e01e5acb65a0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"the", " ", 
    RowBox[{"equation", ":", " ", 
     RowBox[{
      RowBox[{
       FractionBox["1", "Y"], 
       SuperscriptBox["\[CapitalDelta]", "2"], "\[Chi]"}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"3", "-", "\[Nu]"}], ")"}], "Y"], 
       "\[Kappa]\[CapitalDelta]\[Chi]"}], "+", 
      RowBox[{"2", 
       FractionBox[
        RowBox[{"1", "-", "\[Nu]"}], "Y"], 
       SuperscriptBox["\[Kappa]", "2"], "\[Chi]"}]}]}]}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "r"], 
     SubscriptBox["\[CapitalDelta]u", "3"]}], "+", 
    FractionBox[
     RowBox[{"2", 
      SubscriptBox["u", "3"]}], 
     SuperscriptBox["r", "3"]]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.732374632754825*^9, 3.7323746481145573`*^9}, {
  3.732374743965583*^9, 
  3.732374824516925*^9}},ExpressionUUID->"20785b23-c3ea-4cc5-9f60-\
f1861a0269a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Codazzi equation of compatibility", "Section",
 CellChangeTimes->{{3.7323762576614513`*^9, 
  3.732376292650941*^9}},ExpressionUUID->"124a8761-0d06-4687-883e-\
f118116be742"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "Define", " ", "covariant", " ", "derivative", " ", "for", " ", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["(", "0"], ")"}], "2"]}], ")"}], " ", "tensor"}], ",", 
    RowBox[{
     RowBox[{"Di", "[", 
      RowBox[{"c", ",", "i", ",", "j", ",", "k", ",", "Ch"}], "]"}], 
     "\[Rule]", 
     RowBox[{
      SubscriptBox["\[Del]", "i"], 
      SubscriptBox["c", "jk"]}]}], ",", " ", 
    RowBox[{
    "where", " ", "Ch", " ", "is", " ", "the", " ", "array", " ", "of", " ", 
     "Christoffel", " ", "symbols"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Di", "[", 
     RowBox[{"c_", ",", "i_", ",", "j_", ",", "k_", ",", "Ch_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
           RowBox[{"\[Xi]", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "-", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "k"}], "]"}], "]"}], 
             RowBox[{"Ch", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "i", ",", "j"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "n"}], "]"}], "]"}], 
             RowBox[{"Ch", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "i", ",", "k"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "2"}], "}"}]}], "]"}]}], "]"}], "]"}]}], 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7323847492888937`*^9, 3.7323851964056787`*^9}, {
  3.7323854867980433`*^9, 
  3.732385489492731*^9}},ExpressionUUID->"deac16a1-e81e-4536-be64-\
8883a0fa4448"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Define", " ", 
     RowBox[{"ib", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "\[Rule]", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["b", "i"], ")"}], "j"]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"ib", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ig", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "k"}], "]"}], "]"}], 
          RowBox[{"b", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.732385493249937*^9, 3.7323855368744297`*^9}, {
  3.732385582962515*^9, 3.7323856347594624`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"b71cca27-cb09-4408-8efa-454f3d7aa211"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"linearized", " ", "Codazzi", " ", 
    RowBox[{"equation", ":", "\[IndentingNewLine]", "\t", 
     RowBox[{
      SubscriptBox["\[Rho]", 
       RowBox[{"\[Beta]\[Alpha]", "|", "\[Tau]"}]], "-", 
      SubscriptBox["\[Rho]", 
       RowBox[{"\[Tau]\[Alpha]", "|", "\[Beta]"}]]}]}]}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["b", "\[Beta]"], "\[Nu]"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Epsilon]", 
        RowBox[{"\[Alpha]\[Nu]", "|", "\[Tau]"}]], "+", 
       SubscriptBox["\[Epsilon]", 
        RowBox[{"\[Tau]\[Nu]", "|", "\[Alpha]"}]], "-", 
       SubscriptBox["\[Epsilon]", 
        RowBox[{"\[Tau]\[Alpha]", "|", "\[Nu]"}]]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["b", "\[Tau]"], "\[Nu]"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Epsilon]", 
        RowBox[{"\[Alpha]\[Nu]", "|", "\[Beta]"}]], "+", 
       SubscriptBox["\[Epsilon]", 
        RowBox[{"\[Beta]\[Nu]", "|", "\[Alpha]"}]], "-", 
       SubscriptBox["\[Epsilon]", 
        RowBox[{"\[Beta]\[Alpha]", "|", "\[Nu]"}]]}], ")"}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7323858078299723`*^9, 3.732385909408032*^9}, {
  3.732386136547154*^9, 3.732386214730234*^9}, {3.732386750577437*^9, 
  3.732386780726532*^9}},ExpressionUUID->"051c1a8b-4a18-4e59-8fef-\
bbcc26f2be95"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Tau]"}], "}"}], " ", 
      RowBox[{"trivial", ":", " ", "\[Beta]"}]}], "=", 
     RowBox[{
      RowBox[{
      "\[Tau]", " ", "since", " ", "\[Rho]", " ", "is", " ", "symmetric"}], 
      " ", "\[Rule]", " ", 
      RowBox[{"that", " ", "means", " ", "4", " ", "equations"}]}]}], ";", 
    "\[IndentingNewLine]", "then"}], ",", 
   RowBox[{
    RowBox[{"LHS", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Tau]"}], "}"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "LHS"}], 
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[Tau]", ",", "\[Beta]"}], "}"}]}], 
     "\[Rule]", 
     RowBox[{"only", " ", "two", " ", "equations"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.732386243979653*^9, 3.7323862757763157`*^9}, {
  3.732386339398321*^9, 3.732386365802491*^9}, {3.732386805127083*^9, 
  3.732386808653665*^9}, {3.732387670873226*^9, 
  3.732387750340695*^9}},ExpressionUUID->"6b0ebb94-ebea-4c6b-82e1-\
db815d890324"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Tau]"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "LHS", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Di", "[", 
       RowBox[{
       "\[Rho]", ",", "\[Tau]", ",", "\[Beta]", ",", "\[Alpha]", ",", 
        "\[CapitalGamma]"}], "]"}], "-", 
      RowBox[{"Di", "[", 
       RowBox[{
       "\[Rho]", ",", "\[Beta]", ",", "\[Tau]", ",", "\[Alpha]", ",", 
        "\[CapitalGamma]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "RHS", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ib", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "\[Beta]"}], "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Di", "[", 
           RowBox[{
           "\[Epsilon]u", ",", "\[Tau]", ",", "\[Alpha]", ",", "k", ",", 
            "\[CapitalGamma]"}], "]"}], "+", 
          RowBox[{"Di", "[", 
           RowBox[{
           "\[Epsilon]u", ",", "\[Alpha]", ",", "\[Tau]", ",", "k", ",", 
            "\[CapitalGamma]"}], "]"}], "-", 
          RowBox[{"Di", "[", 
           RowBox[{
           "\[Epsilon]u", ",", "k", ",", "\[Tau]", ",", "\[Alpha]", ",", 
            "\[CapitalGamma]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "2"}], "}"}]}], "]"}], "-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ib", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "\[Tau]"}], "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Di", "[", 
           RowBox[{
           "\[Epsilon]u", ",", "\[Beta]", ",", "\[Alpha]", ",", "k", ",", 
            "\[CapitalGamma]"}], "]"}], "+", 
          RowBox[{"Di", "[", 
           RowBox[{
           "\[Epsilon]u", ",", "\[Alpha]", ",", "\[Beta]", ",", "k", ",", 
            "\[CapitalGamma]"}], "]"}], "-", 
          RowBox[{"Di", "[", 
           RowBox[{
           "\[Epsilon]u", ",", "k", ",", "\[Beta]", ",", "\[Alpha]", ",", 
            "\[CapitalGamma]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7323862785967693`*^9, 3.732386291249227*^9}, {
  3.7323863695384007`*^9, 3.7323863724665003`*^9}, {3.7323868136688747`*^9, 
  3.732386825510169*^9}, {3.732387946692327*^9, 3.732387955162093*^9}, {
  3.732388139880663*^9, 
  3.732388158696617*^9}},ExpressionUUID->"395b142a-bd37-41bb-859d-\
3c21d162fe0f"]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{Automatic, 184}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 288, 4, 67, "Section",ExpressionUUID->"a8c6c20f-3e06-420e-8fee-d4bb4fd18b67"],
Cell[871, 28, 1091, 34, 74, "Input",ExpressionUUID->"03e59733-ee43-4d96-82dd-fb86b8782eed"],
Cell[CellGroupData[{
Cell[1987, 66, 13473, 395, 835, "Input",ExpressionUUID->"aa6059a6-d422-4ec4-aa8b-534b92e6ff6c"],
Cell[15463, 463, 1401, 39, 34, "Output",ExpressionUUID->"bcd70b07-9b1b-4ce6-accb-849dc4143a02"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16913, 508, 180, 3, 67, "Section",ExpressionUUID->"ea01728a-a533-41e0-908a-f548677cc4b5"],
Cell[CellGroupData[{
Cell[17118, 515, 7761, 212, 400, "Input",ExpressionUUID->"0b3eb555-58a0-48b1-b0e6-61b5d1f9909b"],
Cell[24882, 729, 321, 6, 34, "Output",ExpressionUUID->"cd3a3d57-4817-4af7-817a-247dcc378942"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25240, 740, 8076, 214, 348, "Input",ExpressionUUID->"5c6fc8ae-4681-42ec-87ef-ef76fb63d06a"],
Cell[33319, 956, 1531, 42, 54, "Output",ExpressionUUID->"8aa6b92f-6320-4006-aed4-17bcd0142b55"],
Cell[34853, 1000, 536, 7, 34, "Output",ExpressionUUID->"8020f955-bd92-4f41-b3e4-d8d92a53b89d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35426, 1012, 10540, 283, 548, "Input",ExpressionUUID->"1e4d7edd-50d0-48f3-a385-ce8061d26687"],
Cell[45969, 1297, 269, 4, 34, "Output",ExpressionUUID->"2334429f-0e0e-45ca-8fdb-372f35670d11"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46275, 1306, 3501, 103, 170, "Input",ExpressionUUID->"68531b8b-b7f2-4c08-8df8-ecbe8d1dc4f1"],
Cell[49779, 1411, 242, 3, 34, "Output",ExpressionUUID->"4e504dcf-c8b0-44bc-b31d-734c1616074b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50058, 1419, 2249, 64, 123, "Input",ExpressionUUID->"57695719-41c5-4d88-820d-a253f940c0b7"],
Cell[52310, 1485, 202, 4, 34, "Output",ExpressionUUID->"4754fb83-a100-4a22-87b4-e01e5acb65a0"]
}, Open  ]],
Cell[52527, 1492, 935, 29, 39, "Input",ExpressionUUID->"20785b23-c3ea-4cc5-9f60-f1861a0269a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53499, 1526, 180, 3, 67, "Section",ExpressionUUID->"124a8761-0d06-4687-883e-f118116be742"],
Cell[53682, 1531, 2132, 61, 159, "Input",ExpressionUUID->"deac16a1-e81e-4536-be64-8883a0fa4448"],
Cell[55817, 1594, 1141, 35, 58, "Input",ExpressionUUID->"b71cca27-cb09-4408-8efa-454f3d7aa211"],
Cell[56961, 1631, 1402, 37, 55, "Input",ExpressionUUID->"051c1a8b-4a18-4e59-8fef-bbcc26f2be95"],
Cell[58366, 1670, 1118, 30, 52, "Input",ExpressionUUID->"6b0ebb94-ebea-4c6b-82e1-db815d890324"],
Cell[59487, 1702, 2808, 76, 178, "Input",ExpressionUUID->"395b142a-bd37-41bb-859d-3c21d162fe0f"]
}, Open  ]]
}
]
*)

